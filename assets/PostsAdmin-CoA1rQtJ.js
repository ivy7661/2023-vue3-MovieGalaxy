import{_,o as a,c as i,a as t,n as u,v as h,d as b,t as m,i as v,F as P,j as w,b as f,r as $,p as D,e as k}from"./index-3RIVRUOS.js";import{m as M}from"./modalMixin-Y75er8yH.js";import{A as r}from"./swal-DYp74Lc_.js";import"./sweetalert2.all-_L_8z6qN.js";const T={props:["tempPost"],mixins:[M],data(){return{viewPost:{}}},watch:{tempPost(){this.viewPost=this.tempPost}}},N={class:"modal fade",ref:"modal",tabindex:"-1"},C={class:"modal-dialog modal-lg"},L={class:"modal-content"},V=t("div",{class:"modal-header bg-dark text-light"},[t("h5",{class:"modal-title"},"會員影評"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1),H={class:"modal-body"},I={class:"mb-3"},S=t("label",{for:"title",class:"form-label"},"標題",-1),A={class:"mb-3"},B=t("label",{for:"userName",class:"form-label"},"發文者",-1),j={class:"mb-3"},F=t("label",{for:"content",class:"form-label"},"內文",-1),U=["innerHTML"],E=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 關閉 ")],-1);function q(o,s,c,p,e,d){return a(),i("div",N,[t("div",C,[t("div",L,[V,t("div",H,[t("div",I,[S,u(t("input",{type:"text",id:"title",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=l=>e.viewPost.title=l),readonly:""},null,512),[[h,e.viewPost.title]])]),t("div",A,[B,u(t("input",{type:"text",id:"userName",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=l=>e.viewPost.userName=l),readonly:""},null,512),[[h,e.viewPost.userName]])]),t("div",j,[F,t("p",{id:"content",class:"form-control",innerHTML:e.viewPost.content},null,8,U)])]),E])])],512)}const z=_(T,[["render",q]]),G={props:["tempPost"],mixins:[M]},J={class:"modal fade",ref:"modal",tabindex:"-1"},K={class:"modal-dialog"},O={class:"modal-content"},Q=t("div",{class:"modal-header bg-danger text-light"},[t("h5",{class:"modal-title"},"刪除影評"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1),R={class:"modal-body"},W={class:"text-danger"},X={class:"modal-footer"},Y=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Z(o,s,c,p,e,d){return a(),i("div",J,[t("div",K,[t("div",O,[Q,t("div",R,[t("p",null,[b(" 確認要刪除標題為 "),t("strong",W,m(c.tempPost.title),1),b(" 之影評嗎？ (刪除後將無法恢復) ")])]),t("div",X,[Y,t("button",{type:"button",class:"btn btn-danger",onClick:s[0]||(s[0]=l=>o.$emit("delPost"))},"確認刪除")])])])],512)}const tt=_(G,[["render",Z]]),st={data(){return{posts:[],tempPost:{}}},components:{PostModal:z,DelPostModal:tt},mounted(){this.getPosts()},methods:{getPosts(){v.get("https://two023-vue3-moviegalaxy.onrender.com/posts").then(s=>{this.posts=s.data}).catch(()=>{r.toastTop("error","取得資料失敗")})},openModal(o,s){o==="view"?(this.tempPost={...s},this.$refs.PostModal.openModal()):o==="delete"&&(this.tempPost={...s},this.$refs.DelPostModal.openModal())},delPost(){const o=`https://two023-vue3-moviegalaxy.onrender.com/posts/${this.tempPost.id}`;v.delete(o).then(s=>{this.$refs.DelPostModal.closeModal(),this.getPosts(),r.toastTop("success","刪除成功")}).catch(()=>{r.toastTop("error","刪除失敗")})}}},y=o=>(D("data-v-15dc11bb"),o=o(),k(),o),ot={class:"row justify-content-center"},et={class:"col-md-11"},lt=y(()=>t("h2",{class:"mb-4"},"影評管理",-1)),nt={class:"table"},dt=y(()=>t("thead",null,[t("tr",null,[t("th",null,"發文者"),t("th",null,"標題"),t("th",null,"內文"),t("th",null,"查看"),t("th",null,"刪除")])],-1)),at=["innerHTML"],it=["onClick"],ct=["onClick"];function rt(o,s,c,p,e,d){const l=$("Post-Modal"),g=$("Del-Post-Modal");return a(),i(P,null,[t("div",ot,[t("div",et,[lt,t("table",nt,[dt,t("tbody",null,[(a(!0),i(P,null,w(e.posts,n=>(a(),i("tr",{key:n.id},[t("td",null,m(n.userName),1),t("td",null,m(n.title),1),t("td",null,[t("p",{class:"post-content",innerHTML:n.content},null,8,at)]),t("td",null,[t("button",{type:"button",class:"btn btn-sm btn-outline-blue",onClick:x=>d.openModal("view",n)}," 查看 ",8,it)]),t("td",null,[t("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:x=>d.openModal("delete",n)}," 刪除 ",8,ct)])]))),128))])])])]),f(l,{ref:"PostModal","temp-post":e.tempPost},null,8,["temp-post"]),f(g,{ref:"DelPostModal","temp-post":e.tempPost,onDelPost:d.delPost},null,8,["temp-post","onDelPost"])],64)}const ht=_(st,[["render",rt],["__scopeId","data-v-15dc11bb"]]);export{ht as default};
